var passport=require("passport");var LocalStrategy=require("passport-local").Strategy;var mongoose=require("mongoose");var User=mongoose.model("User");module.exports=function(){passport.use(new LocalStrategy(function(c,b,a){User.findOne({username:c}).exec(function(e,d){if(d&&d.authenticate(b)){return a(null,d)}else{return a(null,false)}})}));passport.serializeUser(function(b,a){if(b){a(null,b._id)}});passport.deserializeUser(function(b,a){User.findOne({_id:b}).exec(function(d,c){if(c){return a(null,c)}else{return a(null,false)}})})};