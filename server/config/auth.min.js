var passport=require("passport");exports.authenticate=function(d,a,b){d.body.username=d.body.username.toString();var c=passport.authenticate("local",function(f,e){if(f){return b(f)}if(!e){a.send({success:false})}d.logIn(e,function(g){if(g){return b(g)}a.send({success:true,user:e})})});c(d,a,b)};exports.requiresApiLogin=function(c,a,b){if(!c.isAuthenticated()){a.status(403);a.end()}else{b()}};exports.requiresRole=function(a){return function(d,b,c){if(!d.isAuthenticated()||d.user.roles.indexOf(a)===-1){b.status(403);b.end()}else{c()}}};