var mongoose=require("mongoose");var crypto=require("../utilities/encryption");var userSchema=mongoose.Schema({firstName:{type:String,required:"{PATH} is required!"},lastName:{type:String,required:"{PATH} is required!"},username:{type:String,required:"{PATH} is required!",unique:true},email:{type:String,required:"{PATH} is required!"},salt:{type:String,required:"{PATH} is required!"},hashed_pwd:{type:String,required:"{PATH} is required!"},roles:[String],rejects:{type:[Number]},watched:{type:[Number]},later:{type:[Number]}});userSchema.methods={authenticate:function(a){return crypto.hashPwd(this.salt,a)===this.hashed_pwd},hasRole:function(a){return this.roles.indexOf(a)>-1}};var User=mongoose.model("User",userSchema);function createDefaultUsers(){User.find({}).exec(function(b,d){if(d.length===0){var a,c;a=crypto.createSalt();c=crypto.hashPwd(a,"k72898");User.create({firstName:"Michael",lastName:"Botelho",username:"saggiatoreblue",email:"saggiatoreblue@gmail.com",salt:a,hashed_pwd:c,roles:["admin"],rejects:[],watched:[],later:[]})}})}exports.createDefaultUsers=createDefaultUsers;